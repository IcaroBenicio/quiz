<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Avan√ßado ‚Äî Geografia</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Pequenos ajustes visuais adicionais */
    .option-btn { transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease; }
    .option-btn:active { transform: scale(.98); }
    .progress-bar-inner { transition: width .45s cubic-bezier(.2,.9,.2,1); }
    .timer-bar { transition: width 1s linear; background: linear-gradient(90deg,#ffb86b,#ff6b9a); }
    .fade-in { animation: fadeIn .35s ease both; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(6px);} to { opacity: 1; transform: translateY(0);} }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-sky-50 to-amber-50 font-sans">

  <!-- Container central -->
  <div class="max-w-2xl mx-auto p-6">

    <!-- START SCREEN -->
    <section id="startScreen" class="bg-white rounded-xl shadow-lg p-8 text-center">
      <h1 class="text-3xl font-bold text-sky-700 mb-2">Quiz Avan√ßado de Geografia</h1>
      <p class="text-gray-600 mb-6">Teste seus conhecimentos ‚Äî perguntas aleat√≥rias, tempo por pergunta e ranking local.</p>

      <div class="flex flex-col sm:flex-row items-center justify-center gap-3">
        <label class="flex items-center gap-2 text-sm text-gray-700">
          <span>Tempo por pergunta</span>
          <select id="timePerQuestion" class="ml-2 rounded border px-2 py-1">
            <option value="15">15 s</option>
            <option value="20" selected>20 s</option>
            <option value="30">30 s</option>
          </select>
        </label>

        <button id="startBtn" class="mt-4 sm:mt-0 px-6 py-3 bg-sky-600 text-white rounded-lg hover:bg-sky-700 transition">
          Iniciar Quiz
        </button>

        <button id="resumeBtn" class="mt-4 sm:mt-0 px-4 py-2 bg-amber-400 text-white rounded-lg hover:bg-amber-500 transition hidden">
          Retomar
        </button>

        <button id="viewRankingBtn" class="mt-4 sm:mt-0 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition">
          Ver Ranking
        </button>
      </div>
      <p class="text-xs text-gray-400 mt-4">O progresso √© salvo localmente no seu navegador.</p>
    </section>

    <!-- QUIZ CARD -->
    <section id="quizCard" class="hidden mt-6 bg-white rounded-xl shadow-lg p-6 fade-in">
      <!-- topo: t√≠tulo + progress -->
      <div class="mb-4">
        <div class="flex items-center justify-between mb-2">
          <h2 id="cardTitle" class="text-xl font-semibold text-sky-700">Pergunta</h2>
          <div class="text-sm text-gray-600" id="progressText" aria-live="polite">Quest√£o 1 de 5 (0%)</div>
        </div>

        <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
          <div id="progressBar" class="h-3 progress-bar-inner bg-gradient-to-r from-sky-500 to-rose-400 rounded-full" style="width:0%"></div>
        </div>
      </div>

      <!-- Temporizador visual -->
      <div class="relative h-2 bg-gray-100 rounded-full overflow-hidden my-3">
        <div id="timerBar" class="timer-bar absolute left-0 top-0 h-full" style="width:100%"></div>
      </div>
      <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
        <div id="timerText">Tempo: 20s</div>
        <div id="scoreMini">Acertos: 0</div>
      </div>

      <!-- Pergunta & op√ß√µes -->
      <div id="questionBox" class="mb-4">
        <p id="questionText" class="text-lg text-gray-800 font-medium">Pergunta aparece aqui</p>
      </div>

      <div id="options" class="grid gap-3"></div>

      <!-- a√ß√£o -->
      <div class="flex items-center justify-between mt-6">
        <button id="skipBtn" class="px-4 py-2 rounded-md border border-gray-200 text-gray-700 hover:bg-gray-50">Pular</button>
        <div class="flex items-center gap-3">
          <button id="nextBtn" class="px-5 py-2 bg-sky-600 text-white rounded-md hidden">Pr√≥xima</button>
          <button id="quitBtn" class="px-4 py-2 rounded-md border border-red-100 text-red-600 hover:bg-red-50">Sair</button>
        </div>
      </div>
    </section>

    <!-- RESULT SCREEN -->
    <section id="resultCard" class="hidden mt-6 bg-white rounded-xl shadow-lg p-6 text-center">
      <h3 id="resultTitle" class="text-2xl font-bold text-sky-700">Resultado</h3>
      <p id="resultMsg" class="mt-2 text-gray-700"></p>
      <p class="mt-2 text-lg">Pontua√ß√£o: <strong id="finalScore">0</strong> / <span id="totalQ">0</span></p>

      <div id="wrongList" class="mt-4 text-left"></div>

      <div class="mt-6 flex flex-col sm:flex-row gap-3 items-center justify-center">
        <button id="shareBtn" class="px-4 py-2 bg-indigo-500 text-white rounded-md hover:bg-indigo-600">Compartilhar</button>
        <button id="tryAgainBtn" class="px-4 py-2 bg-emerald-500 text-white rounded-md hover:bg-emerald-600">Jogar de novo</button>
        <button id="backHomeBtn" class="px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-100">Voltar</button>
      </div>
    </section>

    <!-- RANKING modal simples -->
    <section id="rankingCard" class="hidden mt-6 bg-white rounded-xl shadow-lg p-6">
      <h3 class="text-xl font-semibold text-sky-700">Ranking (√∫ltimas pontua√ß√µes)</h3>
      <ul id="rankingList" class="mt-4 text-gray-700"></ul>
      <div class="mt-4 flex gap-3">
        <button id="clearRankingBtn" class="px-3 py-2 bg-red-400 text-white rounded-md hover:bg-red-500">Limpar hist√≥rico</button>
        <button id="closeRankingBtn" class="px-3 py-2 bg-gray-200 rounded-md hover:bg-gray-100">Fechar</button>
      </div>
    </section>

  </div>

  <script>
  /**********************
   * Configura√ß√µes / dados
   **********************/
  const STORAGE_KEY = 'quiz_state_v1';
  const HISTORY_KEY = 'quiz_history_v1';

  // perguntas originais (pode ampliar)
  const ALL_QUESTIONS = [
     {
                text: 'A presen√ßa da Cordilheira dos Andes na regi√£o metropolitana de La Paz (Bol√≠via) influenciou a cria√ß√£o de um moderno sistema de:',
                options: ['Metr√¥ subterr√¢neo', 'Telef√©ricos a√©reos', 'Bondes el√©tricos', 'Monotrilho de superf√≠cie'],
                correct: 1
            },
            {
                text: 'A principal causa da viol√™ncia nos pa√≠ses da Am√©rica Latina, segundo o texto da p√°gina 94, est√° ligada √†:',
                options: ['Corrup√ß√£o pol√≠tica generalizada', 'Desigualdade social e falta de oportunidades', 'Defici√™ncia no sistema educacional', 'Excessiva industrializa√ß√£o'],
                correct: 1
            },
            {
                text: 'A urbaniza√ß√£o desordenada na Am√©rica do Sul tem como consequ√™ncia o crescimento de moradias prec√°rias em √°reas de risco, como:',
                options: ['Centros comerciais', '√Åreas rurais planas', 'Encostas de morros e margens de rios', 'Condom√≠nios de alto padr√£o'],
                correct: 2
            },
            {
                text: 'O termo "favela", que hoje designa assentamentos prec√°rios no Brasil, teve origem com a ocupa√ß√£o do Morro da Provid√™ncia por:',
                options: ['Imigrantes europeus', 'Mineradores de ouro', 'Ex-combatentes da Guerra de Canudos', 'Trabalhadores rurais do Sul'],
                correct: 2
            },
            {
                text: 'Em 2022, na Am√©rica Latina e Caribe, o percentual da popula√ß√£o que vivia em condi√ß√µes de extrema pobreza era de, aproximadamente:',
                options: ['5%', '50%', '13%', '32%'],
                correct: 2
            },
            {
                text: 'O que o texto da p√°gina 96 identifica como um dos principais problemas da infraestrutura de transportes na maioria dos pa√≠ses da Am√©rica do Sul?',
                options: ['Excesso de trens de alta velocidade', 'Prioridade √† circula√ß√£o de pedestres', 'O servi√ßo p√∫blico √© gerenciado por empresas privadas e √© caro e de m√° qualidade', 'Investimento maci√ßo em hidrovias'],
                correct: 2
            },
            {
                text: 'A crise h√≠drica, a polui√ß√£o e a impermeabiliza√ß√£o excessiva do solo nas cidades latino-americanas s√£o exemplos de problemas urbanos de ordem:',
                options: ['Social', 'Pol√≠tica', 'Econ√¥mica', 'Ambiental'],
                correct: 3
            },
            {
                text: 'O Movimento dos Trabalhadores Sem Teto (MTST) e o Movimento Passe Livre (MPL) s√£o exemplos de:',
                options: ['Partidos pol√≠ticos', 'Empresas de tecnologia', 'Movimentos sociais urbanos', 'Organismos internacionais'],
                correct: 2
            },
            {
                text: 'O alto √≠ndice de informalidade no trabalho na Am√©rica do Sul significa que a maior parte dos empregos criados est√° em condi√ß√µes:',
                options: ['De pleno emprego e estabilidade', 'Sem garantias ou seguran√ßa para o trabalhador', 'De atua√ß√£o em empresas multinacionais', 'Com sal√°rios acima da m√©dia'],
                correct: 1
            },
            {
                text: 'A segrega√ß√£o socioespacial √© vis√≠vel em cidades como Recife (PE), onde se observa a coexist√™ncia de:',
                options: ['Pr√©dios comerciais e industriais', 'Praias e resorts de luxo', 'Moradias prec√°rias e edif√≠cios de classe m√©dia/alta', 'Parques e √°reas verdes'],
                correct: 2
            },
            {
                text: 'Quais s√£o as duas l√≠nguas majorit√°rias da popula√ß√£o na Am√©rica do Sul, heran√ßa do per√≠odo colonial?',
                options: ['Ingl√™s e Franc√™s', 'Alem√£o e Italiano', 'Espanhol e Portugu√™s', 'Holand√™s e Sueco'],
                correct: 2
            },
            {
                text: 'O conceito de "Explora√ß√£o", ligado √† coloniza√ß√£o, est√° diretamente relacionado a qual atividade econ√¥mica da √©poca?',
                options: ['Cria√ß√£o de universidades', 'Fomento √† ind√∫stria local', 'Extra√ß√£o de recursos naturais (minera√ß√£o e outros)', 'Desenvolvimento de alta tecnologia'],
                correct: 2
            },
            {
                text: 'O aspecto socioecon√¥mico de "Sal√°rio - exporta√ß√£o" √© uma caracter√≠stica da:',
                options: ['Independ√™ncia pol√≠tica', 'Crescimento da ind√∫stria de base', 'Depend√™ncia econ√¥mica', 'Prote√ß√£o ambiental'],
                correct: 2
            },
            {
                text: 'A Mesti√ßagem na popula√ß√£o sul-americana √© o resultado da miscigena√ß√£o entre, principalmente, quais grupos?',
                options: ['Europeus e Asi√°ticos', 'Europeus, Ind√≠genas e Africanos', 'Europeus e Americanos do Norte', 'Somente Ind√≠genas e Africanos'],
                correct: 1
            },
            {
                text: 'O estudo de "Recursos Naturais" na Am√©rica do Sul inclui, principalmente, a presen√ßa de:',
                options: ['Clima frio', 'Minera√ß√£o, cobre, ouro, ferro e vegeta√ß√£o', 'Grandes desertos', 'Baixa biodiversidade'],
                correct: 1
            },
            {
                text: 'Quais atividades agr√°rias est√£o listadas como importantes na teia de conhecimento?',
                options: ['Ca√ßa e pesca em alto-mar', 'Extrativismo vegetal e silvicultura', 'Agricultura e Pecu√°ria', 'Biotecnologia e nanotecnologia'],
                correct: 2
            },
            {
                text: 'A quest√£o da desigualdade e da pobreza √© um aspecto socioecon√¥mico que afeta o continente desde:',
                options: ['O in√≠cio da Guerra Fria', 'O s√©culo XXI', 'O per√≠odo colonial (pa√≠ses historicamente desiguais)', 'A Segunda Guerra Mundial'],
                correct: 2
            },
            {
                text: 'Qual √© o principal objetivo dos projetos de transporte, como a rede de telef√©ricos de La Paz, em regi√µes com obst√°culos geogr√°ficos severos?',
                options: ['Atrair turistas', 'Facilitar a minera√ß√£o', 'Melhorar a mobilidade e integra√ß√£o urbana', 'Reduzir o custo da energia'],
                correct: 2
            },
            {
                text: 'A palavra "crioulo(a)", relacionada √† popula√ß√£o, historicamente se referia aos filhos de:',
                options: ['Africanos no Brasil', 'Ind√≠genas na Am√©rica Central', 'Espanh√≥is nascidos na Am√©rica', 'Franceses no Caribe'],
                correct: 2
            },
            {
                text: 'O conceito de "Refina√ß√£o de recursos" na Col√¥nia era geralmente feito:',
                options: ['Na pr√≥pria Am√©rica, incentivando a ind√∫stria', 'Por meio de cooperativas ind√≠genas', 'Nas metr√≥poles europeias (Portugal e Espanha)', 'Em f√°bricas dos Estados Unidos'],
                correct: 2
            },
            {
                text: 'O Mercosul √© um tipo de bloco econ√¥mico conhecido como:',
                options: ['Zona de Livre Com√©rcio', 'Uni√£o Pol√≠tica', 'Uni√£o Aduaneira', 'Mercado Comum'],
                correct: 2
            },
            {
                text: 'O bloco que foi criado em 1948 com o objetivo de promover a paz, a democracia e os direitos humanos entre os 35 pa√≠ses americanos √© a(o):',
                options: ['OEA (Organiza√ß√£o dos Estados Americanos)', 'ONU', 'Aladi', 'Opep'],
                correct: 0
            },
            {
                text: 'Qual bloco de livre com√©rcio foi substitu√≠do pelo USMCA em 2020?',
                options: ['Alca', 'CAN', 'Nafta', 'Alba-TCP'],
                correct: 2
            },
            {
                text: 'O bloco que visa promover a integra√ß√£o pol√≠tica, econ√¥mica e de infraestrutura dos pa√≠ses sul-americanos e que entrou em suspens√£o em 2017 √© a(o):',
                options: ['Unasul (Uni√£o de Na√ß√µes Sul-Americanas)', 'Mercosul', 'Aladi', 'CAN'],
                correct: 0
            },
            {
                text: 'A Opep (Organiza√ß√£o dos Pa√≠ses Exportadores de Petr√≥leo) √© uma organiza√ß√£o que busca:',
                options: ['Unificar a moeda europeia', 'Promover a integra√ß√£o cultural', 'Coordenar e unificar as pol√≠ticas petrol√≠feras', 'Gerenciar a produ√ß√£o de cobre'],
                correct: 2
            },
            {
                text: 'A sigla CAN (Comunidade Andina de Na√ß√µes) foi criada para promover a integra√ß√£o econ√¥mica, pol√≠tica e social entre quais pa√≠ses, principalmente?',
                options: ['Brasil, Argentina, Uruguai', 'EUA, M√©xico, Canad√°', 'Bol√≠via, Col√¥mbia, Equador, Peru', 'Nig√©ria, Ir√£, Ar√°bia Saudita'],
                correct: 2
            },
            {
                text: 'A ALBA-TCP (Alian√ßa Bolivariana para os Povos de Nossa Am√©rica) tem como principal foco:',
                options: ['A livre circula√ß√£o de capitais', 'A cria√ß√£o de um banco privado', 'A √™nfase no social, na sa√∫de e na diminui√ß√£o da desigualdade', 'A constru√ß√£o de grandes rodovias'],
                correct: 2
            },
            {
                text: 'A Aladi (Associa√ß√£o Latino-Americana de Integra√ß√£o) tem o objetivo primordial de:',
                options: ['Criar um banco de desenvolvimento', 'Focar na √°rea militar', 'Estabelecer, progressivamente, um mercado comum latino-americano', 'Unificar o sistema de transportes'],
                correct: 2
            },
            {
                text: 'O principal objetivo da OEI (Organiza√ß√£o dos Estados Ibero-Americanos) √© o avan√ßo nos campos da:',
                options: ['Economia e Com√©rcio', 'Educa√ß√£o, Ci√™ncia, Tecnologia e Cultura', 'Esportes e Lazer', 'Agricultura e Pecu√°ria'],
                correct: 1
            },
            {
                text: 'Em 2020, o Chile era um membro associado, mas n√£o pleno, de qual importante bloco sul-americano?',
                options: ['OTCA', 'Opep', 'Mercosul', 'Caricom'],
                correct: 2
            },
            {
                text: 'O principal objetivo da OTCA (Organiza√ß√£o do Tratado de Coopera√ß√£o Amaz√¥nica) √© proteger:',
                options: ['O petr√≥leo do Oriente M√©dio', 'O meio ambiente e o desenvolvimento sustent√°vel da Amaz√¥nia', 'Os interesses comerciais dos EUA', 'A produ√ß√£o de carros el√©tricos'],
                correct: 1
            },
            {
                text: 'Qual organismo de integra√ß√£o regional re√∫ne 12 na√ß√µes do Caribe e busca a integra√ß√£o econ√¥mica, social e pol√≠tica?',
                options: ['CAN', 'Unasul', 'Aladi', 'Caricom (Comunidade do Caribe)'],
                correct: 3
            },
            {
                text: 'A Aladi (Associa√ß√£o Latino-Americana de Integra√ß√£o) tem o objetivo primordial de:',
                options: ['Criar um banco de desenvolvimento', 'Focar na √°rea militar', 'Estabelecer, progressivamente, um mercado comum latino-americano', 'Unificar o sistema de transportes'],
                correct: 2
            },
            {
                text: 'O desemprego estrutural √© aquele causado principalmente:',
                options: ['Por crises econ√¥micas passageiras', 'Pela falta de investimento p√∫blico', 'Pela moderniza√ß√£o das f√°bricas e substitui√ß√£o do trabalho por m√°quinas', 'Pelo avan√ßo da agricultura'],
                correct: 2
            },
            {
                text: 'O Prosul (F√≥rum para o Progresso e Integra√ß√£o da Am√©rica do Sul) foi lan√ßado em 2019 com a proposta de ser mais leve e flex√≠vel que a:',
                options: ['OEA', 'Unasul', 'Mercosul', 'CAN'],
                correct: 1
            },
            {
                text: 'Qual √© o √≥rg√£o financeiro criado com o objetivo de apoiar o desenvolvimento dos pa√≠ses membros, especialmente em projetos de setores como infraestrutura e sustentabilidade?',
                options: ['FMI', 'OEA', 'Banco de desenvolvimento (NBD - Novo Banco de Desenvolvimento)', 'Banco Mundial'],
                correct: 2
            },
            {
                text: 'O Sistema de Uni√£o Monet√°ria mais bem-sucedido do mundo √©:',
                options: ['O D√≥lar americano', 'A Libra esterlina', 'O Euro', 'O Yuan chin√™s'],
                correct: 2
            },
            {
                text: 'A diferen√ßa entre a Linha Azul e a Linha Verde na rede de telef√©ricos de La Paz (Bol√≠via) √© que elas interligam:',
                options: ['Diferentes bairros nobres', 'Apenas zonas rurais', 'Diferentes pontos da regi√£o metropolitana (interligando diferentes altitudes)', 'Aeroportos internacionais'],
                correct: 2
            },
            {
                text: 'A guerra ao crime organizado √© citada na p√°gina 94 como uma das a√ß√µes que podem ajudar a:',
                options: ['Aumentar a informalidade', 'Reduzir o com√©rcio exterior', 'Melhorar a qualidade de vida e diminuir a viol√™ncia nas cidades latino-americanas', 'Diminuir o √≠ndice de escolaridade'],
                correct: 2
            },
            {
                text: 'A ALCA (√Årea de Livre Com√©rcio das Am√©ricas) n√£o foi concretizada. Qual era o seu principal objetivo?',
                options: ['A uni√£o aduaneira da Am√©rica do Sul', 'A cria√ß√£o de um parlamento regional', 'A elimina√ß√£o gradual das barreiras alfandeg√°rias entre todos os pa√≠ses das Am√©ricas', 'A coordena√ß√£o das pol√≠ticas petrol√≠feras'],
                correct: 2
            },

             { text: 'O termo "gentrifica√ß√£o" descreve o processo de revitaliza√ß√£o de √°reas urbanas que resulta na valoriza√ß√£o do local e, consequentemente, na:', options: ['Diminui√ß√£o do custo de vida', 'Aumento da popula√ß√£o de baixa renda', 'Expuls√£o de moradores de baixa renda', 'Aumento de espa√ßos verdes'], correct: 2 },
            { text: 'A "cidade informal" ou "prec√°ria" se desenvolve principalmente pela incapacidade do setor formal de absorver a for√ßa de trabalho, resultando em moradias sem:', options: ['Conex√£o com a internet', 'Acesso a mercados pr√≥ximos', 'Regulariza√ß√£o fundi√°ria e infraestrutura b√°sica', '√Åreas de lazer e entretenimento'], correct: 2 },
            { text: 'Qual √© a principal diferen√ßa entre o desemprego conjuntural e o desemprego estrutural?', options: ['Um √© causado por crises econ√¥micas, o outro por moderniza√ß√£o tecnol√≥gica', 'Um afeta o setor de servi√ßos, o outro o industrial', 'Um √© sazonal, o outro √© permanente', 'Um afeta trabalhadores qualificados, o outro n√£o qualificados'], correct: 0 },
            { text: 'O crescimento urbano desordenado, a partir do s√©culo XX na Am√©rica do Sul, est√° diretamente ligado a qual fen√¥meno social e econ√¥mico?', options: ['Queda nas taxas de natalidade', '√äxodo rural em larga escala', 'Aumento do turismo internacional', 'Obrigatoriedade de morar nas cidades'], correct: 1 },
            { text: 'A "segrega√ß√£o socioespacial" √© uma das marcas da urbaniza√ß√£o latino-americana, onde as classes sociais se separam no espa√ßo urbano. Qual √© a principal consequ√™ncia disso para a popula√ß√£o mais pobre?', options: ['Melhor acesso a servi√ßos p√∫blicos', 'Maior integra√ß√£o social', 'Pior acesso a empregos, sa√∫de e educa√ß√£o', 'Redu√ß√£o da informalidade'], correct: 2 },
            { text: 'A "depend√™ncia econ√¥mica" dos pa√≠ses da Am√©rica do Sul em rela√ß√£o a na√ß√µes mais desenvolvidas √© uma heran√ßa colonial que se perpetuou pelo modelo de:', options: ['Ind√∫stria pesada', 'Com√©rcio triangular', 'Economia prim√°rio-exportadora', 'Economia de servi√ßos'], correct: 2 },
            { text: 'Qual foi o principal objetivo das reformas urbanas no final do s√©culo XIX, como a do Rio de Janeiro, que, na pr√°tica, levou √† expuls√£o da popula√ß√£o pobre do centro?', options: ['Combater a criminalidade', 'Embelezar a cidade e moderniz√°-la', 'Reduzir a popula√ß√£o total', 'Fomentar a habita√ß√£o popular'], correct: 1 },
            { text: 'O conceito de "Mesti√ßagem" na Am√©rica do Sul n√£o se limita apenas √† mistura biol√≥gica, mas tamb√©m a qual processo cultural?', options: ['Homogeneiza√ß√£o cultural', 'Sincretismo religioso e cultural', 'Isolamento de tradi√ß√µes', 'Supress√£o de idiomas'], correct: 1 },
            { text: 'A teia de conhecimento menciona que a "coloniza√ß√£o de explora√ß√£o" resultou em pa√≠ses com "sociedades desiguais". Qual o principal fator que contribuiu para essa desigualdade?', options: ['Ado√ß√£o de diferentes idiomas', 'A concentra√ß√£o de terras e riquezas nas m√£os de poucos', 'A falta de recursos naturais', 'A escassez de m√£o de obra'], correct: 1 },
            { text: 'O "com√©rcio" no per√≠odo colonial era um monop√≥lio. Quem detinha esse monop√≥lio e como isso afetava a economia da col√¥nia?', options: ['As col√¥nias, que controlavam as exporta√ß√µes', 'Os ind√≠genas, que controlavam as rotas comerciais', 'As metr√≥poles, que controlavam o que era comprado e vendido', 'Os Estados Unidos, que controlavam o com√©rcio internacional'], correct: 2 },
            { text: 'A cria√ß√£o do Mercosul como "uni√£o aduaneira" significa que os pa√≠ses membros adotaram uma TEC (Tarifa Externa Comum). O que a TEC faz?', options: ['Isenta todos os produtos de impostos', 'Aplica a mesma tarifa para produtos importados de fora do bloco', 'Cria impostos internos entre os membros', 'Permite que cada pa√≠s negocie tarifas separadamente'], correct: 1 },
            { text: 'A UNASUL, que se propunha a ser uma organiza√ß√£o intergovernamental para a integra√ß√£o sul-americana, entrou em suspens√£o. Qual foi a principal raz√£o para isso?', options: ['Crise econ√¥mica', 'Diverg√™ncias ideol√≥gicas e pol√≠ticas entre os l√≠deres', 'Guerra civil entre membros', 'Ades√£o de novos membros'], correct: 1 },
            { text: 'O acordo comercial entre os EUA, M√©xico e Canad√° (USMCA) substituiu o NAFTA. Qual a principal altera√ß√£o desse novo acordo?', options: ['Aumento de tarifas para todos os membros', 'Redu√ß√£o da prote√ß√£o de direitos autorais', 'Novas regras para a ind√∫stria automobil√≠stica', 'Inclus√£o de pa√≠ses da Am√©rica do Sul'], correct: 2 },
            { text: 'Qual organismo de integra√ß√£o √© considerado o mais antigo do hemisf√©rio ocidental e tem sede em Washington, D.C.?', options: ['OEA', 'ALADI', 'CAN', 'CARICOM'], correct: 0 },
            { text: 'A "desigualdade" √© uma heran√ßa colonial. Qual grupo social, na hierarquia colonial, tinha o maior poder e privil√©gios?', options: ['Ind√≠genas e escravos', 'Mesti√ßos e crioulos', 'Crioulos', 'Chapetones'], correct: 3 },
            { text: 'O Movimento dos Trabalhadores Rurais Sem Terra (MST) e o Movimento dos Trabalhadores Sem Teto (MTST) se diferenciam principalmente pelo foco de sua luta. Qual a diferen√ßa?', options: ['O MST luta por reforma agr√°ria no campo; o MTST por moradia digna nas cidades', 'O MST luta por acesso a cr√©dito; o MTST por transporte p√∫blico', 'O MST √© um movimento urbano; o MTST √© um movimento rural', 'O MST luta contra a informalidade; o MTST luta contra o desemprego'], correct: 0 },
            { text: 'O texto sobre "infraestrutura de transportes" na Am√©rica do Sul aponta que, em muitos pa√≠ses, o sistema √© de m√° qualidade e caro. A culpa √© atribu√≠da a qual modelo de gest√£o?', options: ['Gest√£o p√∫blica com pouco investimento', 'Gest√£o privada com monop√≥lios', 'Gest√£o mista, p√∫blica e privada', 'Gest√£o cooperativa'], correct: 1 },
            { text: 'O conceito de "sal√°rio-exporta√ß√£o" no modelo de desenvolvimento sul-americano significa que o sal√°rio do trabalhador √© baixo, o que tem um impacto direto em qual outro fator?', options: ['Aumento do poder de compra', 'Aumento das exporta√ß√µes', 'Aumento da d√≠vida externa', 'Diminui√ß√£o do mercado interno'], correct: 3 },
            { text: 'A "Crise H√≠drica" √© um problema ambiental urbano. Qual √© uma das causas principais desse problema nas grandes cidades?', options: ['Aumento da √°rea rural', 'Consumo excessivo e falta de planejamento', 'Uso de energia e√≥lica', 'Chuva excessiva'], correct: 1 },
            { text: 'A OEI, Organiza√ß√£o dos Estados Ibero-americanos, tem foco na educa√ß√£o, ci√™ncia, tecnologia e cultura, reunindo pa√≠ses da Am√©rica Latina, Espanha e qual outro pa√≠s europeu?', options: ['Portugal', 'Fran√ßa', 'It√°lia', 'Alemanha'], correct: 0 },
            { text: 'A ALBA-TCP, Alian√ßa Bolivariana para os Povos de Nossa Am√©rica, se diferencia por ter uma perspectiva ideol√≥gica que prioriza a coopera√ß√£o e solidariedade em oposi√ß√£o a qual modelo econ√¥mico?', options: ['Liberalismo', 'Socialismo', 'Capitalismo', 'Comunismo'], correct: 2 },
            { text: 'A principal diferen√ßa entre uma "Zona de Livre Com√©rcio" e uma "Uni√£o Aduaneira" √© a presen√ßa da:', options: ['Livre circula√ß√£o de pessoas', 'Tarifa Externa Comum', 'Moeda √∫nica', 'Pol√≠tica externa comum'], correct: 1 },
            { text: 'Qual organismo de integra√ß√£o, que tem como membros pa√≠ses da Am√©rica do Sul e o M√©xico, foca no desenvolvimento de um "mercado comum" a longo prazo?', options: ['MERCOSUL', 'ALADI', 'UNASUL', 'OEA'], correct: 1 },
            { text: 'O termo "subemprego" se refere a trabalhadores que est√£o empregados, mas que n√£o conseguem ter uma renda suficiente para cobrir os gastos essenciais. √â um problema muito presente em √°reas urbanas de qual regi√£o?', options: ['Am√©rica do Sul', 'Europa Ocidental', 'Am√©rica do Norte', 'Jap√£o'], correct: 0 },
            { text: 'A "crise h√≠drica" e a "polui√ß√£o" s√£o problemas ambientais urbanos na Am√©rica Latina, resultado da falta de:', options: ['√Årvores', 'Esgoto e saneamento b√°sico', 'Planejamento e gest√£o de recursos', 'Carros el√©tricos'], correct: 2 },
            { text: 'A "guerra ao crime organizado" √© citada como uma das medidas para combater a viol√™ncia. No entanto, o texto aponta que essa medida √© incompleta sem a a√ß√£o em qual outro setor?', options: ['Turismo', 'Educa√ß√£o e social', 'Agr√≠cola', 'Industrial'], correct: 1 },
            { text: 'O Chile, citado na p√°gina 115, √© um membro associado do Mercosul. O que isso significa para o pa√≠s?', options: ['Ele n√£o participa das reuni√µes', 'Ele tem acesso a tarifas especiais, mas n√£o assina a TEC', 'Ele √© um membro pleno com direito a voto', 'Ele √© um observador sem poder decis√≥rio'], correct: 1 },
            { text: 'A Opep, Organiza√ß√£o dos Pa√≠ses Exportadores de Petr√≥leo, teve sua funda√ß√£o motivada por qual objetivo principal?', options: ['Reduzir o pre√ßo do petr√≥leo', 'Controlar a produ√ß√£o e garantir a estabilidade dos pre√ßos', 'Aumentar a concorr√™ncia no mercado', 'Promover a energia renov√°vel'], correct: 1 },
            { text: 'A teia de conhecimento relaciona o "Colonialismo" com o "Sal√°rio - exporta√ß√£o", mostrando que o baixo custo da m√£o de obra era usado para:', options: ['Melhorar o mercado interno', 'Aumentar a competitividade das exporta√ß√µes', 'Aumentar o poder de compra', 'Aumentar a diversifica√ß√£o econ√¥mica'], correct: 1 },
            { text: 'Qual das seguintes cidades latino-americanas √© um exemplo de metr√≥pole com alta segrega√ß√£o socioespacial?', options: ['Montevid√©u', 'Assun√ß√£o', 'Recife', 'Havana'], correct: 2 },
            { text: 'O termo "m√£o de obra escrava", na teia de conhecimento, refere-se principalmente √† explora√ß√£o de quais grupos?', options: ['Somente ind√≠genas', 'Somente europeus', 'Ind√≠genas e africanos', 'Somente africanos'], correct: 2 },
            { text: 'A teia de conhecimento na p√°gina 99, ao falar de recursos naturais, menciona "Solo F√©rtil" e "√Ågua". Qual atividade econ√¥mica se beneficia diretamente desses recursos?', options: ['Minera√ß√£o', 'Pecu√°ria', 'Ind√∫stria', 'Silvicultura'], correct: 1 },
            { text: 'O que o texto da p√°gina 92 quer dizer quando se refere a "crescimento ca√≥tico" na Am√©rica do Sul?', options: ['Crescimento econ√¥mico acelerado', 'Aumento desordenado da popula√ß√£o nas cidades', 'Cria√ß√£o de parques e √°reas verdes', 'Aumento de transportes p√∫blicos'], correct: 1 },
            { text: 'O "subemprego", que afeta a maioria dos trabalhadores na Am√©rica do Sul, tem um impacto direto em qual outro problema social?', options: ['Aumento do poder de compra', 'Aumento das taxas de emprego formal', 'Diminui√ß√£o da informalidade', 'Pobreza e baixa qualidade de vida'], correct: 3 },
            { text: 'O Prosul (F√≥rum para o Progresso e Integra√ß√£o da Am√©rica do Sul), criado em 2019, foi uma iniciativa para substituir qual bloco, considerado ineficiente e burocr√°tico?', options: ['OEA', 'UNASUL', 'ALADI', 'MERCOSUL'], correct: 1 },
            { text: 'A "segrega√ß√£o socioespacial" em √°reas urbanas pode ser vista na diferen√ßa entre o acesso a servi√ßos p√∫blicos entre a popula√ß√£o de bairros ricos e a de √°reas perif√©ricas, como:', options: ['Acesso a transporte privado', 'Acesso a hospitais e escolas de qualidade', 'Acesso a carros de luxo', 'Acesso a internet de banda larga'], correct: 1 },
            { text: 'A OEA, Organiza√ß√£o dos Estados Americanos, possui quais dois objetivos principais, al√©m de promover a democracia e os direitos humanos?', options: ['Coopera√ß√£o econ√¥mica e desenvolvimento social', 'Coopera√ß√£o militar e pol√≠tica', 'Com√©rcio e seguran√ßa', 'Integra√ß√£o cultural e esportiva'], correct: 0 },
            { text: 'O Chile e o Peru s√£o membros plenos da Comunidade Andina (CAN). Qual a principal caracter√≠stica da CAN?', options: ['√â um mercado comum', '√â um bloco de livre com√©rcio', '√â uma uni√£o aduaneira', '√â uma alian√ßa pol√≠tica'], correct: 2 },
    // adicione mais perguntas aqui se quiser
  ];

  /**********************
   * Estado e elementos
   **********************/
  let questions = []; // embaralhadas
  let timePerQuestion = 20;
  let currentIndex = 0;
  let score = 0;
  let wrongs = [];
  let timerInterval = null;
  let remaining = 0;
  let paused = false;

  // elementos DOM
  const startScreen = document.getElementById('startScreen');
  const startBtn = document.getElementById('startBtn');
  const resumeBtn = document.getElementById('resumeBtn');
  const viewRankingBtn = document.getElementById('viewRankingBtn');
  const timePerQuestionSel = document.getElementById('timePerQuestion');

  const quizCard = document.getElementById('quizCard');
  const questionText = document.getElementById('questionText');
  const optionsEl = document.getElementById('options');
  const progressBar = document.getElementById('progressBar');
  const progressText = document.getElementById('progressText');
  const timerBar = document.getElementById('timerBar');
  const timerText = document.getElementById('timerText');
  const scoreMini = document.getElementById('scoreMini');
  const nextBtn = document.getElementById('nextBtn');
  const skipBtn = document.getElementById('skipBtn');
  const quitBtn = document.getElementById('quitBtn');

  const resultCard = document.getElementById('resultCard');
  const resultMsg = document.getElementById('resultMsg');
  const finalScore = document.getElementById('finalScore');
  const totalQ = document.getElementById('totalQ');
  const wrongList = document.getElementById('wrongList');
  const shareBtn = document.getElementById('shareBtn');
  const tryAgainBtn = document.getElementById('tryAgainBtn');
  const backHomeBtn = document.getElementById('backHomeBtn');

  const rankingCard = document.getElementById('rankingCard');
  const rankingList = document.getElementById('rankingList');
  const viewRanking = document.getElementById('viewRankingBtn');
  const clearRankingBtn = document.getElementById('clearRankingBtn');
  const closeRankingBtn = document.getElementById('closeRankingBtn');

  // bot√£o retomar
  const resumeButton = document.getElementById('resumeBtn');

  /**********************
   * Utilit√°rios
   **********************/
  function shuffleArray(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }

  function saveState(){
    const state = { questions, timePerQuestion, currentIndex, score, wrongs, remaining, paused };
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  }

  function loadState(){
    const raw = localStorage.getItem(STORAGE_KEY);
    if(!raw) return null;
    try { return JSON.parse(raw); } catch(e){ return null; }
  }

  function clearState(){
    localStorage.removeItem(STORAGE_KEY);
  }

  function addHistoryEntry(sc){
    const raw = localStorage.getItem(HISTORY_KEY);
    const arr = raw ? JSON.parse(raw) : [];
    arr.unshift({ score: sc, total: questions.length, date: new Date().toISOString() });
    // guarda s√≥ √∫ltimos 20
    localStorage.setItem(HISTORY_KEY, JSON.stringify(arr.slice(0,20)));
  }

  function getHistory(){ const raw = localStorage.getItem(HISTORY_KEY); return raw ? JSON.parse(raw) : []; }

  /**********************
   * Tela Inicial / start
   **********************/
  function showStartScreen(){
    startScreen.classList.remove('hidden');
    quizCard.classList.add('hidden');
    resultCard.classList.add('hidden');
    rankingCard.classList.add('hidden');

    // se existe estado salvo, habilita retomar
    const st = loadState();
    if(st) resumeBtn.classList.remove('hidden'); else resumeBtn.classList.add('hidden');
  }

  // inicia um novo jogo
  function initNewQuiz(){
    timePerQuestion = Number(timePerQuestionSel.value) || 20;
    questions = shuffleArray([...ALL_QUESTIONS]).map(q => ({
      text: q.text,
      // vamos embaralhar op√ß√µes mantendo index correto
      options: shuffleArray(q.options.map((opt, idx) => ({ opt, idx })))
    })).map(q=>{
      // recuperar index da correta
      // find original correct index (we'll map original ALL_QUESTIONS by text)
      const original = ALL_QUESTIONS.find(originalQ => originalQ.text === q.text);
      const correctIdxOriginal = ALL_QUESTIONS.indexOf(original) >=0 ? original.correct : 0;
      // but above mapping is tricky; simpler approach: during map maintain correct value via matching:
      return q;
    });

    // simpler rebuild: ensure correct mapping by rebuilding from ALL_QUESTIONS with shuffle
    questions = shuffleArray(ALL_QUESTIONS).map(item => {
      const shuffledOptions = shuffleArray(item.options.map((opt, idx)=> ({ opt, idx })));
      // determine index in shuffledOptions where idx === item.correct
      const correctShuffledIndex = shuffledOptions.findIndex(o => o.idx === item.correct);
      return {
        text: item.text,
        options: shuffledOptions.map(o=>o.opt),
        correct: correctShuffledIndex
      };
    });

    currentIndex = 0;
    score = 0;
    wrongs = [];
    remaining = timePerQuestion;
    paused = false;
    saveState();
    openQuiz();
  }

  function openQuiz(){
    startScreen.classList.add('hidden');
    quizCard.classList.remove('hidden');
    resultCard.classList.add('hidden');
    rankingCard.classList.add('hidden');
    renderQuestion();
    startTimer();
  }

  /**********************
   * Retomar (carregar estado salvo)
   **********************/
  function tryResume(){
    const st = loadState();
    if(!st) return alert('Nenhum progresso salvo.');
    // recuperar perguntas (j√° v√™m do storage)
    questions = st.questions;
    timePerQuestion = st.timePerQuestion || 20;
    currentIndex = st.currentIndex || 0;
    score = st.score || 0;
    wrongs = st.wrongs || [];
    remaining = st.remaining || timePerQuestion;
    paused = !!st.paused;
    timePerQuestionSel.value = timePerQuestion;
    openQuiz();
    resumeBtn.classList.add('hidden');
  }

  /**********************
   * Render / l√≥gica
   **********************/
  function renderQuestion(){
    // verificar √≠ndice
    if(currentIndex >= questions.length){
      finishQuiz();
      return;
    }

    const q = questions[currentIndex];
    questionText.textContent = q.text;
    optionsEl.innerHTML = '';

    q.options.forEach((opt, i) => {
      const btn = document.createElement('button');
      btn.className = 'option-btn option-button bg-gray-50 border border-transparent rounded-xl px-4 py-3 text-left w-full flex items-center gap-3';
      btn.innerHTML = `<span class="flex-1">${opt}</span><span class="ml-2 opacity-0 transition-opacity" aria-hidden="true"></span>`;
      btn.dataset.index = i;

      // teclado: Enter / Space
      btn.addEventListener('keydown', e => { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); btn.click(); } });

      btn.addEventListener('click', () => {
        // se j√° desabilitado
        if(btn.classList.contains('disabled')) return;
        handleAnswer(i, btn);
      });

      optionsEl.appendChild(btn);
    });

    updateProgressUI();
    scoreMini.textContent = `Acertos: ${score}`;
    timerText.textContent = `Tempo: ${remaining}s`;
    timerBar.style.width = `${(remaining/timePerQuestion)*100}%`;
    nextBtn.classList.add('hidden');
  }

  function updateProgressUI(){
    const pct = Math.round((currentIndex / questions.length) * 100);
    progressBar.style.width = pct + '%';
    progressText.textContent = `Quest√£o ${Math.min(currentIndex+1, questions.length)} de ${questions.length} (${pct}%)`;
  }

  /**********************
   * Temporizador
   **********************/
  function startTimer(){
    stopTimer();
    timerInterval = setInterval(() => {
      if(paused) return;
      remaining--;
      if(remaining < 0) remaining = 0;
      timerText.textContent = `Tempo: ${remaining}s`;
      timerBar.style.width = `${(remaining/timePerQuestion)*100}%`;
      saveState();

      if(remaining === 0){
        // tempo esgotou = contar como erro e avan√ßar
        markTimeout();
      }
    }, 1000);
  }

  function stopTimer(){
    if(timerInterval) { clearInterval(timerInterval); timerInterval = null; }
  }

  function markTimeout(){
    // revelar resposta correta e marcar erro
    const q = questions[currentIndex];
    const optionsButtons = [...optionsEl.children];
    optionsButtons.forEach((btn, i) => {
      btn.classList.add('disabled');
      if(i === q.correct){
        btn.classList.add('correct');
        const icon = document.createElement('span'); icon.textContent = ' ‚úÖ'; btn.appendChild(icon);
      }
    });
    // registrar como errado
    wrongs.push({ question: q.text, chosen: null, correct: q.options[q.correct] });
    nextBtn.classList.remove('hidden');
    stopTimer();
    saveState();
  }

  /**********************
   * Resposta do usu√°rio
   **********************/
  function handleAnswer(selectedIndex, btn){
    const q = questions[currentIndex];
    const buttons = [...optionsEl.children];
    // desabilita todos
    buttons.forEach(b => { b.classList.add('disabled'); });
    // marca sele√ß√£o
    if(selectedIndex === q.correct){
      btn.classList.add('correct');
      btn.style.background = '#dcfce7';
      score++;
      const tick = document.createElement('span'); tick.textContent = ' ‚úÖ'; tick.className='ml-2'; btn.appendChild(tick);
    } else {
      btn.classList.add('incorrect');
      btn.style.background = '#fee2e2';
      const cross = document.createElement('span'); cross.textContent = ' ‚ùå'; cross.className='ml-2'; btn.appendChild(cross);
      // mostra o correto
      const correctBtn = buttons[q.correct];
      if(correctBtn){
        correctBtn.classList.add('correct');
        const tick = document.createElement('span'); tick.textContent = ' ‚úÖ'; tick.className='ml-2'; correctBtn.appendChild(tick);
      }
      wrongs.push({ question: q.text, chosen: q.options[selectedIndex], correct: q.options[q.correct] });
    }

    // pequeno delay para salvar e permitir ver o feedback
    stopTimer();
    nextBtn.classList.remove('hidden');
    saveState();
  }

  /**********************
   * navegar pr√≥ximas / pular / sair
   **********************/
  nextBtn.addEventListener('click', () => {
    currentIndex++;
    remaining = timePerQuestion;
    saveState();
    if(currentIndex < questions.length){
      renderQuestion();
      startTimer();
    } else {
      finishQuiz();
    }
  });

  skipBtn.addEventListener('click', () => {
    // marcar como pulo = tratado como errada sem chosen
    const q = questions[currentIndex];
    wrongs.push({ question: q.text, chosen: null, correct: q.options[q.correct] });
    currentIndex++;
    remaining = timePerQuestion;
    saveState();
    if(currentIndex < questions.length){
      renderQuestion();
      startTimer();
    } else {
      finishQuiz();
    }
  });

  quitBtn.addEventListener('click', () => {
    if(confirm('Deseja realmente sair e salvar seu progresso para retomar depois?')) {
      saveState();
      showStartScreen();
    }
  });

  /**********************
   * Finalizar quiz / resultados
   **********************/
  function finishQuiz(){
    stopTimer();
    saveState(); // guarda estado final
    // mostrar resultados
    quizCard.classList.add('hidden');
    resultCard.classList.remove('hidden');

    finalScore.textContent = score;
    totalQ.textContent = questions.length;
    // mensagem personalizada
    const pct = Math.round((score / questions.length) * 100);
    let msg = '';
    if(pct === 100) msg = 'Perfeito! Voc√™ domina o assunto. üëè';
    else if(pct >= 80) msg = 'Excelente! Muito bem.';
    else if(pct >= 50) msg = 'Bom trabalho ‚Äî continue praticando.';
    else msg = 'N√£o desanime ‚Äî pr√°tica leva √† melhora!';

    resultMsg.textContent = msg;

    // lista de erradas
    wrongList.innerHTML = '';
    if(wrongs.length){
      const h = document.createElement('h4'); h.className='font-semibold text-red-600'; h.textContent = 'Quest√µes que voc√™ errou:'; wrongList.appendChild(h);
      wrongs.forEach(w => {
        const div = document.createElement('div');
        div.className = 'mt-2 p-3 bg-red-50 rounded';
        div.innerHTML = `<p class="text-sm"><strong>‚ùì ${w.question}</strong></p>
                         <p class="text-xs text-red-600">Sua resposta: ${w.chosen ?? '‚Äî (n√£o respondeu)'}</p>
                         <p class="text-xs text-green-700">Resposta certa: ${w.correct}</p>`;
        wrongList.appendChild(div);
      });
    } else {
      const p = document.createElement('p'); p.className='text-green-700 font-semibold'; p.textContent = 'üéâ Voc√™ n√£o errou nenhuma quest√£o!';
      wrongList.appendChild(p);
    }

    // salvar hist√≥rico e limpar estado salvo
    addHistoryEntry(score);
    clearState();
    renderRanking(); // atualiza ranking na mem√≥ria
  }

  /**********************
   * Compartilhar / ranking
   **********************/
  shareBtn.addEventListener('click', async () => {
    const text = `Fiz o Quiz e acertei ${score} de ${questions.length} perguntas!`;
    if(navigator.share){
      try { await navigator.share({ title:'Meu resultado', text }); }
      catch(e){ alert('Compartilhamento cancelado.'); }
    } else {
      // fallback: link whatsapp
      const url = `https://api.whatsapp.com/send?text=${encodeURIComponent(text)}`;
      window.open(url, '_blank');
    }
  });

  tryAgainBtn.addEventListener('click', () => { initNewQuiz(); });
  backHomeBtn.addEventListener('click', () => { showStartScreen(); });

  viewRankingBtn.addEventListener('click', () => {
    startScreen.classList.add('hidden');
    quizCard.classList.add('hidden');
    resultCard.classList.add('hidden');
    rankingCard.classList.remove('hidden');
    renderRanking();
  });

  closeRankingBtn.addEventListener('click', () => {
    showStartScreen();
  });

  clearRankingBtn.addEventListener('click', () => {
    if(confirm('Limpar todo o hist√≥rico de pontua√ß√µes?')) {
      localStorage.removeItem(HISTORY_KEY);
      renderRanking();
    }
  });

  function renderRanking(){
    const hist = getHistory();
    rankingList.innerHTML = '';
    if(!hist.length){
      rankingList.innerHTML = '<p class="text-gray-500">Nenhuma pontua√ß√£o registrada.</p>';
      return;
    }
    hist.forEach((h, i) => {
      const li = document.createElement('li');
      const date = new Date(h.date);
      li.className = 'py-2 border-b last:border-b-0';
      li.innerHTML = `<strong>#${i+1}</strong> ‚Äî <span class="ml-2 font-semibold">${h.score}/${h.total}</span> <span class="ml-2 text-xs text-gray-500">(${date.toLocaleString()})</span>`;
      rankingList.appendChild(li);
    });
  }
  
  /**********************
   * In√≠cio / eventos de UI
   **********************/
  startBtn.addEventListener('click', () => { initNewQuiz(); });
  resumeBtn.addEventListener('click', tryResume);
  timePerQuestionSel.addEventListener('change', (e) => { /* s√≥ muda na nova sess√£o */ });

  // checar se existe estado salvo para habilitar retomar
  (function init(){
    const st = loadState();
    if(st) resumeBtn.classList.remove('hidden'); else resumeBtn.classList.add('hidden');
    renderRanking();
  })();

  </script>
</body>
</html>





























































