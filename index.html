<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Avan√ßado ‚Äî Portugu√™s
  </title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Pequenos ajustes visuais adicionais */
    .option-btn { transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease; }
    .option-btn:active { transform: scale(.98); }
    .progress-bar-inner { transition: width .45s cubic-bezier(.2,.9,.2,1); }
    .timer-bar { transition: width 1s linear; background: linear-gradient(90deg,#ffb86b,#ff6b9a); }
    .fade-in { animation: fadeIn .35s ease both; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(6px);} to { opacity: 1; transform: translateY(0);} }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-sky-50 to-amber-50 font-sans">

  <!-- Container central -->
  <div class="max-w-2xl mx-auto p-6">

    <!-- START SCREEN -->
    <section id="startScreen" class="bg-white rounded-xl shadow-lg p-8 text-center">
      <h1 class="text-3xl font-bold text-sky-700 mb-2">Quiz Avan√ßado de Geografia</h1>
      <p class="text-gray-600 mb-6">Teste seus conhecimentos ‚Äî perguntas aleat√≥rias, tempo por pergunta e ranking local.</p>

      <div class="flex flex-col sm:flex-row items-center justify-center gap-3">
        <label class="flex items-center gap-2 text-sm text-gray-700">
          <span>Tempo por pergunta</span>
          <select id="timePerQuestion" class="ml-2 rounded border px-2 py-1">
            <option value="15">15 s</option>
            <option value="20000" selected>20000 s</option>
            <option value="30">30 s</option>
          </select>
        </label>

        <button id="startBtn" class="mt-4 sm:mt-0 px-6 py-3 bg-sky-600 text-white rounded-lg hover:bg-sky-700 transition">
          Iniciar Quiz
        </button>

        <button id="resumeBtn" class="mt-4 sm:mt-0 px-4 py-2 bg-amber-400 text-white rounded-lg hover:bg-amber-500 transition hidden">
          Retomar
        </button>

        <button id="viewRankingBtn" class="mt-4 sm:mt-0 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition">
          Ver Ranking
        </button>
      </div>
      <p class="text-xs text-gray-400 mt-4">O progresso √© salvo localmente no seu navegador.</p>
    </section>

    <!-- QUIZ CARD -->
    <section id="quizCard" class="hidden mt-6 bg-white rounded-xl shadow-lg p-6 fade-in">
      <!-- topo: t√≠tulo + progress -->
      <div class="mb-4">
        <div class="flex items-center justify-between mb-2">
          <h2 id="cardTitle" class="text-xl font-semibold text-sky-700">Pergunta</h2>
          <div class="text-sm text-gray-600" id="progressText" aria-live="polite">Quest√£o 1 de 5 (0%)</div>
        </div>

        <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
          <div id="progressBar" class="h-3 progress-bar-inner bg-gradient-to-r from-sky-500 to-rose-400 rounded-full" style="width:0%"></div>
        </div>
      </div>

      <!-- Temporizador visual -->
      <div class="relative h-2 bg-gray-100 rounded-full overflow-hidden my-3">
        <div id="timerBar" class="timer-bar absolute left-0 top-0 h-full" style="width:100%"></div>
      </div>
      <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
        <div id="timerText">Tempo: 20000s</div>
        <div id="scoreMini">Acertos: 0</div>
      </div>

      <!-- Pergunta & op√ß√µes -->
      <div id="questionBox" class="mb-4">
        <p id="questionText" class="text-lg text-gray-800 font-medium">Pergunta aparece aqui</p>
      </div>

      <div id="options" class="grid gap-3"></div>

      <!-- a√ß√£o -->
      <div class="flex items-center justify-between mt-6">
        <button id="skipBtn" class="px-4 py-2 rounded-md border border-gray-200 text-gray-700 hover:bg-gray-50">Pular</button>
        <div class="flex items-center gap-3">
          <button id="nextBtn" class="px-5 py-2 bg-sky-600 text-white rounded-md hidden">Pr√≥xima</button>
          <button id="quitBtn" class="px-4 py-2 rounded-md border border-red-100 text-red-600 hover:bg-red-50">Sair</button>
        </div>
      </div>
    </section>

    <!-- RESULT SCREEN -->
    <section id="resultCard" class="hidden mt-6 bg-white rounded-xl shadow-lg p-6 text-center">
      <h3 id="resultTitle" class="text-2xl font-bold text-sky-700">Resultado</h3>
      <p id="resultMsg" class="mt-2 text-gray-700"></p>
      <p class="mt-2 text-lg">Pontua√ß√£o: <strong id="finalScore">0</strong> / <span id="totalQ">0</span></p>

      <div id="wrongList" class="mt-4 text-left"></div>

      <div class="mt-6 flex flex-col sm:flex-row gap-3 items-center justify-center">
        <button id="shareBtn" class="px-4 py-2 bg-indigo-500 text-white rounded-md hover:bg-indigo-600">Compartilhar</button>
        <button id="tryAgainBtn" class="px-4 py-2 bg-emerald-500 text-white rounded-md hover:bg-emerald-600">Jogar de novo</button>
        <button id="backHomeBtn" class="px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-100">Voltar</button>
      </div>
    </section>

    <!-- RANKING modal simples -->
    <section id="rankingCard" class="hidden mt-6 bg-white rounded-xl shadow-lg p-6">
      <h3 class="text-xl font-semibold text-sky-700">Ranking (√∫ltimas pontua√ß√µes)</h3>
      <ul id="rankingList" class="mt-4 text-gray-700"></ul>
      <div class="mt-4 flex gap-3">
        <button id="clearRankingBtn" class="px-3 py-2 bg-red-400 text-white rounded-md hover:bg-red-500">Limpar hist√≥rico</button>
        <button id="closeRankingBtn" class="px-3 py-2 bg-gray-200 rounded-md hover:bg-gray-100">Fechar</button>
      </div>
    </section>

  </div>

  <script>
  /**********************
   * Configura√ß√µes / dados
   **********************/
  const STORAGE_KEY = 'quiz_state_v1';
  const HISTORY_KEY = 'quiz_history_v1';

  // perguntas originais (pode ampliar)
  const ALL_QUESTIONS = [
  {
    "text": "1. Nome do terceiro maior continente em extens√£o territorial.",
    "options": [
      "Am√©rica",
      "√Åsia",
      "√Åfrica",
      "Europa"
    ],
    "correct": 2
  },
  {
    "text": "2. Importante bioma considerado *hotspot* encontrado no extremo sul e no extremo norte da √Åfrica.",
    "options": [
      "Floresta do Congo",
      "Karoo Suculento",
      "Bioma do Atlas",
      "Savana"
    ],
    "correct": 1
  },
  {
    "text": "3. Tipo de bioma que no Brasil √© conhecido como *Cerrado*.",
    "options": [
      "Tundra",
      "Savana",
      "Taiga",
      "Floresta Temperada"
    ],
    "correct": 1
  },
  {
    "text": "4. Tipo de vegeta√ß√£o encontrado no planalto da Eti√≥pia, com plantas escassas e de baixo porte.",
    "options": [
      "Floresta Tropical",
      "Vegeta√ß√£o de Deserto",
      "Vegeta√ß√£o de Altitude (Alpine)",
      "Manguezais"
    ],
    "correct": 2
  },
  {
    "text": "5. Tipos de estruturas geol√≥gicas predominantes na √Åfrica.",
    "options": [
      "Dobramentos Modernos e Bacias Sedimentares",
      "Escudos Cristalinos e Bacias Sedimentares",
      "Plataformas Est√°veis e Vulc√µes Ativos",
      "Dobramentos Modernos e Escudos Cristalinos"
    ],
    "correct": 1
  },
  {
    "text": "6. Tipo de recurso natural muito explorado nos *escudos cristalinos*.",
    "options": [
      "Petr√≥leo e G√°s Natural",
      "Carv√£o Mineral",
      "Recursos minerais met√°licos (Ex: Ferro, Ouro)",
      "√Ågua subterr√¢nea"
    ],
    "correct": 2
  },
  {
    "text": "7. Importante rio que atravessa o *Equador duas vezes*.",
    "options": [
      "Rio Nilo",
      "Rio N√≠ger",
      "Rio Zambeze",
      "Rio Congo"
    ],
    "correct": 3
  },
  {
    "text": "8. Importantes mares que banham a √Åfrica nas por√ß√µes *norte e nordeste*.",
    "options": [
      "Mar B√°ltico e Mar Negro",
      "Mar Mediterr√¢neo e Mar Vermelho",
      "Mar do Caribe e Mar do Norte",
      "Mar Egeu e Mar C√°spio"
    ],
    "correct": 1
  },
  {
    "text": "9. Nome do importante *dobramento moderno* da √Åfrica.",
    "options": [
      "Montes Drakensberg",
      "Planaltos Centrais",
      "Cordilheira do Atlas",
      "Rift Valley"
    ],
    "correct": 2
  },
  {
    "text": "10. Conceito que se refere √† natureza das rochas e comp√µe um relevo.",
    "options": [
      "Climatologia",
      "Hidrografia",
      "Geologia/Estrutura Geol√≥gica",
      "Biogeografia"
    ],
    "correct": 2
  },
  {
    "text": "11. Nome dado ao conjunto de falhas tect√¥nicas que se estende por mais de 5 mil km, cobrindo uma √°rea que vai desde a S√≠ria at√© Mo√ßambique.",
    "options": [
      "Cintur√£o Alpino",
      "Great Rift Valley (Vale do Rift)",
      "Dorsal Mesoatl√¢ntica",
      "Cadeia do Atlas"
    ],
    "correct": 1
  },
  {
    "text": "12. Nome do limite da placa que faz com que as terras se separem.",
    "options": [
      "Limite Convergente",
      "Limite Transformante",
      "Limite Divergente",
      "Limite Transcorrente"
    ],
    "correct": 2
  },
  {
    "text": "13. Nome da floresta que se apresenta densa, pesada, alta e com grande biodiversidade, e se desenvolve em climas quentes e √∫midos na √Åfrica.",
    "options": [
      "Caatinga Africana",
      "Floresta do Congo",
      "Floresta do Atlas",
      "Floresta das Montanhas Ruwenzori"
    ],
    "correct": 1
  },
  {
    "text": "14. Nome da mais importante floresta africana.",
    "options": [
      "Floresta Amaz√¥nica",
      "Floresta Boreal",
      "Floresta do Congo",
      "Floresta de Born√©u"
    ],
    "correct": 2
  },
  {
    "text": "15. Bioma que apresenta vegeta√ß√£o herb√°cea e arbustiva, em climas com esta√ß√£o chuvosa e seca.",
    "options": [
      "Tundra",
      "Taiga",
      "Savana",
      "Floresta Equatorial"
    ],
    "correct": 2
  },
  {
    "text": "16. Nome da faixa do clima semi√°rido que separa o Deserto do Saara das savanas e que est√° em elevado processo de desertifica√ß√£o.",
    "options": [
      "Magreb",
      "Sahel",
      "Serengeti",
      "Kalahari"
    ],
    "correct": 1
  },
  {
    "text": "17. Nome da √°rea que concentra em suas proximidades muitos vulc√µes e os lagos Niassa e Tanganica.",
    "options": [
      "Bacia do Congo",
      "Vale do Rift (Rift Valley)",
      "Deserto do Saara",
      "Plan√≠cie Costeira"
    ],
    "correct": 1
  },
  {
    "text": "18. Nome do monte formado por um vulc√£o situado na Tanz√¢nia, o mais alto de toda a √Åfrica.",
    "options": [
      "Monte Atlas",
      "Monte Qu√™nia",
      "Monte Ruwenzori",
      "Monte Kilimanjaro"
    ],
    "correct": 3
  },
  {
    "text": "19. Nome dos principais rios africanos.",
    "options": [
      "Rio Reno e Rio Dan√∫bio",
      "Rio Nilo e Rio Congo",
      "Rio Mississipi e Rio Amazonas",
      "Rio Amarelo e Rio Yangtz√©"
    ],
    "correct": 1
  },
  {
    "text": "20. O Rio Nilo apresenta uma esta√ß√£o em que as chuvas transportam sedimentos e fertilizam o solo, permitindo a pr√°tica da agricultura. Qual o nome dessa esta√ß√£o?",
    "options": [
      "Seca",
      "Inverno",
      "Cheia (ou Inunda√ß√£o)",
      "Vazante"
    ],
    "correct": 2
  },
  {
    "text": "21. Importante rio africano muito utilizado para agricultura, pesca, transporte e energia.",
    "options": [
      "Rio Orange",
      "Rio Nilo",
      "Rio Zambeze",
      "Rio Limpopo"
    ],
    "correct": 1
  },
  {
    "text": "22. Importante elemento f√≠sico que define os *biomas*.",
    "options": [
      "Latitude e Longitude",
      "Estrutura Geol√≥gica",
      "Clima (Temperatura e Precipita√ß√£o)",
      "Corrente Mar√≠tima"
    ],
    "correct": 2
  },
  {
    "text": "23. Onde est√£o concentrados os maiores e principais desertos da √Åfrica.",
    "options": [
      "Por√ß√£o Leste",
      "Por√ß√£o Central",
      "Por√ß√£o Norte e Sul",
      "Regi√£o do Golfo da Guin√©"
    ],
    "correct": 2
  },
  {
    "text": "24. Clima que ocorre pr√≥ximo ao Equador.",
    "options": [
      "Subtropical",
      "Temperado",
      "Equatorial",
      "Mediterr√¢neo"
    ],
    "correct": 2
  },
  {
    "text": "25. Clima com √≠ndices *baixos de precipita√ß√£o*, chuvas mal distribu√≠das e √© tropical.",
    "options": [
      "Clima Equatorial",
      "Clima Subtropical √ömido",
      "Clima Semi√°rido",
      "Clima Polar"
    ],
    "correct": 2
  },
  {
    "text": "26. Nome do gr√°fico que apresenta a varia√ß√£o de temperatura representada por uma linha e a representa√ß√£o da chuva por colunas.",
    "options": [
      "Histograma",
      "Gr√°fico de Barras",
      "Climograma",
      "Gr√°fico de Setores"
    ],
    "correct": 2
  },
  {
    "text": "27. Grande problema do Rio Congo que impede a liga√ß√£o do mesmo entre v√°rias cidades.",
    "options": [
      "Polui√ß√£o Industrial",
      "Grandes Cataratas e R√°pidos",
      "Baixo Volume de √Ågua",
      "Conflitos Armados"
    ],
    "correct": 1
  },
  {
    "text": "28. Uma importante caracter√≠stica do Rio Congo que impede a navega√ß√£o.",
    "options": [
      "Longos trechos planos",
      "Profundidade elevada",
      "Presen√ßa de quedas d'√°gua e corredeiras",
      "Curvas suaves"
    ],
    "correct": 2
  },
  {
    "text": "29. Nome de um importante rio da √Åfrica Ocidental.",
    "options": [
      "Rio Nilo",
      "Rio N√≠ger",
      "Rio Zambeze",
      "Rio Orange"
    ],
    "correct": 1
  },
  {
    "text": "30. O importante rio africano muito utilizado para pesca, agricultura e transporte, que garante o sustento de grande parte da popula√ß√£o.",
    "options": [
      "Rio Congo",
      "Rio Orange",
      "Rio Nilo",
      "Rio Limpopo"
    ],
    "correct": 2
  },
  {
    "text": "31. Importante pa√≠s africano rico em minerais.",
    "options": [
      "Egito",
      "Rep√∫blica Democr√°tica do Congo (RDC)",
      "L√≠bia",
      "Nig√©ria"
    ],
    "correct": 1
  },
  {
    "text": "32. Grande respons√°vel pela polui√ß√£o em diversas √°reas da √Åfrica.",
    "options": [
      "Atividade Petrol√≠fera/Industrial e descarte de lixo do Ocidente",
      "Atividade Tur√≠stica",
      "Agricultura de Subsist√™ncia",
      "Presen√ßa de Biomas Des√©rticos"
    ],
    "correct": 0
  },
  {
    "text": "33. Pa√≠ses onde foram encontrados diversos aqu√≠feros nas bacias sedimentares no norte da √Åfrica (Ex: Aqu√≠fero N√∫bio).",
    "options": [
      "Nig√©ria e Gana",
      "Egito, L√≠bia, Sud√£o e Chade",
      "Angola e Nam√≠bia",
      "√Åfrica do Sul e Lesoto"
    ],
    "correct": 1
  },
  {
    "text": "34. Nome da barragem constru√≠da no Rio Nilo que acabou com a irregularidade das cheias, permitindo maior produ√ß√£o de energia e agricultura.",
    "options": [
      "Barragem de Kariba",
      "Barragem de Assu√£",
      "Barragem das Tr√™s Gargantas",
      "Barragem de Grand Ethiopian Renaissance"
    ],
    "correct": 1
  },
  {
    "text": "35. Clima predominante da √Åfrica.",
    "options": [
      "Clima Mediterr√¢neo",
      "Clima Tropical",
      "Clima Polar",
      "Clima Temperado"
    ],
    "correct": 1
  },
  {
    "text": "36. O continente africano apresenta paisagens e climas semelhantes ao norte e ao sul. Isso significa que o continente tem uma simetria em rela√ß√£o a qual elemento geogr√°fico?",
    "options": [
      "C√≠rculo Polar √Årtico",
      "Meridiano de Greenwich",
      "Tr√≥pico de C√¢ncer",
      "Linha do Equador"
    ],
    "correct": 3
  },
  {
    "text": "37. Regi√£o da √Åfrica com maior √≠ndice pluviom√©trico.",
    "options": [
      "Deserto do Saara",
      "Bacia do Rio Congo (regi√£o equatorial)",
      "Regi√£o do Cabo (√Åfrica do Sul)",
      "Regi√£o do Sahel"
    ],
    "correct": 1
  },
  {
    "text": "38. Nome da √°rea em meio ao deserto onde h√° afloramento de √°guas subterr√¢neas.",
    "options": [
      "Duna",
      "O√°sis",
      "Erg",
      "Hamada"
    ],
    "correct": 1
  },
  {
    "text": "39. Em que por√ß√£o da √Åfrica est√° sendo constru√≠da ou plantada a *Grande Muralha Verde*?",
    "options": [
      "Extremo Sul (Kalahari)",
      "Borda Norte do Deserto do Saara",
      "Regi√£o do Sahel (faixa de transi√ß√£o sul do Saara)",
      "Pr√≥ximo ao Rio Nilo"
    ],
    "correct": 2
  },
  {
    "text": "40. O maior objetivo da implanta√ß√£o do Projeto da Muralha Verde √© impedir a...",
    "options": [
      "Expans√£o da Agricultura de Exporta√ß√£o",
      "Desertifica√ß√£o",
      "Imigra√ß√£o para a Europa",
      "Constru√ß√£o de Novas Cidades"
    ],
    "correct": 1
  },
  {
    "text": "41. O que significa *hotspot*?",
    "options": [
      "Ponto de concentra√ß√£o de ind√∫strias",
      "Ponto de alta atividade vulc√¢nica",
      "√Årea com grande biodiversidade e alto grau de amea√ßa",
      "Zona de baixa precipita√ß√£o e seca"
    ],
    "correct": 2
  },
  {
    "text": "42. Continente considerado ber√ßo da humanidade.",
    "options": [
      "√Åsia",
      "√Åfrica",
      "Am√©rica do Sul",
      "Europa"
    ],
    "correct": 1
  },
  {
    "text": "43. Nome dado ao ciclo colonial que se iniciou no s√©culo XIX, que levou as na√ß√µes europeias a darem in√≠cio a uma expans√£o imperialista sobre os continentes africano e asi√°tico.",
    "options": [
      "Globaliza√ß√£o",
      "Neocolonialismo",
      "Feudalismo",
      "Mercantilismo"
    ],
    "correct": 1
  },
  {
    "text": "44. Elementos essenciais na √Åfrica de interesse dos europeus, para suprir a demanda durante a Revolu√ß√£o Industrial.",
    "options": [
      "M√£o de obra e commodities agr√≠colas",
      "Mat√©rias-primas e mercados consumidores",
      "Servi√ßos e tecnologia",
      "Energia solar e e√≥lica"
    ],
    "correct": 1
  },
  {
    "text": "45. M√£o de obra utilizada na explora√ß√£o europeia na √Åfrica, principalmente para minera√ß√£o e planta√ß√£o.",
    "options": [
      "M√£o de obra assalariada",
      "M√£o de obra escrava",
      "Trabalhadores aut√¥nomos",
      "M√£o de obra qualificada"
    ],
    "correct": 1
  },
  {
    "text": "46. Nome dado ao processo de emancipa√ß√£o de territ√≥rios coloniais em rela√ß√£o √†s metr√≥poles colonizadoras, resultando na independ√™ncia das col√¥nias.",
    "options": [
      "Coloniza√ß√£o",
      "Descoloniza√ß√£o",
      "Globaliza√ß√£o",
      "Gentrifica√ß√£o"
    ],
    "correct": 1
  },
  {
    "text": "47. Ano do fim da Segunda Guerra Mundial, que marcou o in√≠cio dos movimentos de liberta√ß√£o na √Åfrica.",
    "options": [
      "1918",
      "1939",
      "1945",
      "1968"
    ],
    "correct": 2
  },
  {
    "text": "48. Um dos grandes problemas do p√≥s-independ√™ncia (descoloniza√ß√£o) africana.",
    "options": [
      "Conflitos e guerras civis",
      "Forte crescimento econ√¥mico",
      "Estabilidade pol√≠tica",
      "Integra√ß√£o social"
    ],
    "correct": 0
  },
  {
    "text": "49. O nome dado √†s rivalidades √©tnicas e religiosas, de movimentos separatistas, governos opressores e ditaduras, que geram conflitos.",
    "options": [
      "Integra√ß√£o",
      "Tribais",
      "Desenvolvimento",
      "Coopera√ß√£o"
    ],
    "correct": 1
  },
  {
    "text": "50. Regi√£o da √Åfrica Ocidental que reivindica separa√ß√£o.",
    "options": [
      "√Åfrica do Sul",
      "Saara Ocidental",
      "Eti√≥pia",
      "Madagascar"
    ],
    "correct": 1
  },
  {
    "text": "51. Pa√≠s africano que concentra grandes reservas de fosfato e min√©rio de ferro.",
    "options": [
      "Egito",
      "Nig√©ria",
      "Marrocos",
      "Angola"
    ],
    "correct": 2
  },
  {
    "text": "52. Forma de consulta popular sobre um assunto de grande relev√¢ncia, na qual o povo manifesta-se sobre uma lei ‚Äî seja ordin√°ria, complementar ou emenda √† Constitui√ß√£o.",
    "options": [
      "Plebiscito",
      "Referendo",
      "Elei√ß√£o Direta",
      "Vota√ß√£o Secreta"
    ],
    "correct": 1
  },
  {
    "text": "53. Territ√≥rio situado a noroeste da √Åfrica que reivindica, ainda hoje, a separa√ß√£o atrav√©s de referendo.",
    "options": [
      "Sud√£o do Sul",
      "Eritreia",
      "Saara Ocidental",
      "Djibouti"
    ],
    "correct": 2
  },
  {
    "text": "54. Nome do movimento que gerou uma s√©rie de protestos de rua nos pa√≠ses √°rabes do norte da √Åfrica e do Oriente M√©dio, a partir de 2010.",
    "options": [
      "Guerra Fria",
      "Primavera √Årabe",
      "Revolu√ß√£o Industrial",
      "Neocolonialismo"
    ],
    "correct": 1
  },
  {
    "text": "55. Pa√≠s que se tornou conhecido como 'Chifre da √Åfrica'.",
    "options": [
      "Nig√©ria",
      "Som√°lia",
      "√Åfrica do Sul",
      "Rep√∫blica Democr√°tica do Congo"
    ],
    "correct": 1
  },
  {
    "text": "56. Problemas mais graves de Som√°lia, Guerra Civil, fome, pobreza, mis√©ria, e a√ß√£o de grupos armados, resist√™ncia de governos ditadores.",
    "options": [
      "Alto desenvolvimento industrial",
      "Grandes problemas sociais e conflitos",
      "Forte estabilidade pol√≠tica",
      "Alta taxa de IDH"
    ],
    "correct": 1
  },
  {
    "text": "57. Nome da capital do Sud√£o do Sul.",
    "options": [
      "Cartum",
      "Juba",
      "Mogad√≠scio",
      "Quito"
    ],
    "correct": 1
  },
  {
    "text": "58. Importante mineral encontrado no Sul do Sud√£o.",
    "options": [
      "Ouro",
      "Petr√≥leo",
      "Diamante",
      "Carv√£o"
    ],
    "correct": 1
  },
  {
    "text": "59. Pa√≠s africano que surgiu em 2011 ap√≥s separa√ß√£o do Sud√£o.",
    "options": [
      "Eritreia",
      "Sud√£o do Sul",
      "Djibouti",
      "N√≠ger"
    ],
    "correct": 1
  },
  {
    "text": "60. Etnias que est√£o em conflito em Ruanda.",
    "options": [
      "Zulu e Xhosa",
      "Hutus e Tutsis",
      "Berberes e √Årabes",
      "Bantu e Pigmeus"
    ],
    "correct": 1
  },
  {
    "text": "61. Nome que se d√° √† morte de grandes grupos cujo objetivo √© eliminar pessoas por quest√µes pol√≠ticas, religiosas, √©tnicas ou militares.",
    "options": [
      "Terrorismo",
      "Etnoc√≠dio/Genoc√≠dio",
      "Guerra Civil",
      "Revolu√ß√£o"
    ],
    "correct": 1
  },
  {
    "text": "62. Nome que se d√° √† morte de elementos culturais de um povo.",
    "options": [
      "Etnoc√≠dio",
      "Genoc√≠dio",
      "Holocausto",
      "Assass√≠nio"
    ],
    "correct": 0
  }
]

  /**********************
   * Estado e elementos
   **********************/
  let questions = []; // embaralhadas
  let timePerQuestion = 20;
  let currentIndex = 0;
  let score = 0;
  let wrongs = [];
  let timerInterval = null;
  let remaining = 0;
  let paused = false;

  // elementos DOM
  const startScreen = document.getElementById('startScreen');
  const startBtn = document.getElementById('startBtn');
  const resumeBtn = document.getElementById('resumeBtn');
  const viewRankingBtn = document.getElementById('viewRankingBtn');
  const timePerQuestionSel = document.getElementById('timePerQuestion');

  const quizCard = document.getElementById('quizCard');
  const questionText = document.getElementById('questionText');
  const optionsEl = document.getElementById('options');
  const progressBar = document.getElementById('progressBar');
  const progressText = document.getElementById('progressText');
  const timerBar = document.getElementById('timerBar');
  const timerText = document.getElementById('timerText');
  const scoreMini = document.getElementById('scoreMini');
  const nextBtn = document.getElementById('nextBtn');
  const skipBtn = document.getElementById('skipBtn');
  const quitBtn = document.getElementById('quitBtn');

  const resultCard = document.getElementById('resultCard');
  const resultMsg = document.getElementById('resultMsg');
  const finalScore = document.getElementById('finalScore');
  const totalQ = document.getElementById('totalQ');
  const wrongList = document.getElementById('wrongList');
  const shareBtn = document.getElementById('shareBtn');
  const tryAgainBtn = document.getElementById('tryAgainBtn');
  const backHomeBtn = document.getElementById('backHomeBtn');

  const rankingCard = document.getElementById('rankingCard');
  const rankingList = document.getElementById('rankingList');
  const viewRanking = document.getElementById('viewRankingBtn');
  const clearRankingBtn = document.getElementById('clearRankingBtn');
  const closeRankingBtn = document.getElementById('closeRankingBtn');

  // bot√£o retomar
  const resumeButton = document.getElementById('resumeBtn');

  /**********************
   * Utilit√°rios
   **********************/
  function shuffleArray(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }

  function saveState(){
    const state = { questions, timePerQuestion, currentIndex, score, wrongs, remaining, paused };
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  }

  function loadState(){
    const raw = localStorage.getItem(STORAGE_KEY);
    if(!raw) return null;
    try { return JSON.parse(raw); } catch(e){ return null; }
  }

  function clearState(){
    localStorage.removeItem(STORAGE_KEY);
  }

  function addHistoryEntry(sc){
    const raw = localStorage.getItem(HISTORY_KEY);
    const arr = raw ? JSON.parse(raw) : [];
    arr.unshift({ score: sc, total: questions.length, date: new Date().toISOString() });
    // guarda s√≥ √∫ltimos 20
    localStorage.setItem(HISTORY_KEY, JSON.stringify(arr.slice(0,20)));
  }

  function getHistory(){ const raw = localStorage.getItem(HISTORY_KEY); return raw ? JSON.parse(raw) : []; }

  /**********************
   * Tela Inicial / start
   **********************/
  function showStartScreen(){
    startScreen.classList.remove('hidden');
    quizCard.classList.add('hidden');
    resultCard.classList.add('hidden');
    rankingCard.classList.add('hidden');

    // se existe estado salvo, habilita retomar
    const st = loadState();
    if(st) resumeBtn.classList.remove('hidden'); else resumeBtn.classList.add('hidden');
  }

  // inicia um novo jogo
  function initNewQuiz(){
    timePerQuestion = Number(timePerQuestionSel.value) || 20;
    questions = shuffleArray([...ALL_QUESTIONS]).map(q => ({
      text: q.text,
      // vamos embaralhar op√ß√µes mantendo index correto
      options: shuffleArray(q.options.map((opt, idx) => ({ opt, idx })))
    })).map(q=>{
      // recuperar index da correta
      // find original correct index (we'll map original ALL_QUESTIONS by text)
      const original = ALL_QUESTIONS.find(originalQ => originalQ.text === q.text);
      const correctIdxOriginal = ALL_QUESTIONS.indexOf(original) >=0 ? original.correct : 0;
      // but above mapping is tricky; simpler approach: during map maintain correct value via matching:
      return q;
    });

    // simpler rebuild: ensure correct mapping by rebuilding from ALL_QUESTIONS with shuffle
    questions = shuffleArray(ALL_QUESTIONS).map(item => {
      const shuffledOptions = shuffleArray(item.options.map((opt, idx)=> ({ opt, idx })));
      // determine index in shuffledOptions where idx === item.correct
      const correctShuffledIndex = shuffledOptions.findIndex(o => o.idx === item.correct);
      return {
        text: item.text,
        options: shuffledOptions.map(o=>o.opt),
        correct: correctShuffledIndex
      };
    });

    currentIndex = 0;
    score = 0;
    wrongs = [];
    remaining = timePerQuestion;
    paused = false;
    saveState();
    openQuiz();
  }

  function openQuiz(){
    startScreen.classList.add('hidden');
    quizCard.classList.remove('hidden');
    resultCard.classList.add('hidden');
    rankingCard.classList.add('hidden');
    renderQuestion();
    startTimer();
  }

  /**********************
   * Retomar (carregar estado salvo)
   **********************/
  function tryResume(){
    const st = loadState();
    if(!st) return alert('Nenhum progresso salvo.');
    // recuperar perguntas (j√° v√™m do storage)
    questions = st.questions;
    timePerQuestion = st.timePerQuestion || 20;
    currentIndex = st.currentIndex || 0;
    score = st.score || 0;
    wrongs = st.wrongs || [];
    remaining = st.remaining || timePerQuestion;
    paused = !!st.paused;
    timePerQuestionSel.value = timePerQuestion;
    openQuiz();
    resumeBtn.classList.add('hidden');
  }

  /**********************
   * Render / l√≥gica
   **********************/
  function renderQuestion(){
    // verificar √≠ndice
    if(currentIndex >= questions.length){
      finishQuiz();
      return;
    }

    const q = questions[currentIndex];
    questionText.textContent = q.text;
    optionsEl.innerHTML = '';

    q.options.forEach((opt, i) => {
      const btn = document.createElement('button');
      btn.className = 'option-btn option-button bg-gray-50 border border-transparent rounded-xl px-4 py-3 text-left w-full flex items-center gap-3';
      btn.innerHTML = `<span class="flex-1">${opt}</span><span class="ml-2 opacity-0 transition-opacity" aria-hidden="true"></span>`;
      btn.dataset.index = i;

      // teclado: Enter / Space
      btn.addEventListener('keydown', e => { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); btn.click(); } });

      btn.addEventListener('click', () => {
        // se j√° desabilitado
        if(btn.classList.contains('disabled')) return;
        handleAnswer(i, btn);
      });

      optionsEl.appendChild(btn);
    });

    updateProgressUI();
    scoreMini.textContent = `Acertos: ${score}`;
    timerText.textContent = `Tempo: ${remaining}s`;
    timerBar.style.width = `${(remaining/timePerQuestion)*100}%`;
    nextBtn.classList.add('hidden');
  }

  function updateProgressUI(){
    const pct = Math.round((currentIndex / questions.length) * 100);
    progressBar.style.width = pct + '%';
    progressText.textContent = `Quest√£o ${Math.min(currentIndex+1, questions.length)} de ${questions.length} (${pct}%)`;
  }

  /**********************
   * Temporizador
   **********************/
  function startTimer(){
    stopTimer();
    timerInterval = setInterval(() => {
      if(paused) return;
      remaining--;
      if(remaining < 0) remaining = 0;
      timerText.textContent = `Tempo: ${remaining}s`;
      timerBar.style.width = `${(remaining/timePerQuestion)*100}%`;
      saveState();

      if(remaining === 0){
        // tempo esgotou = contar como erro e avan√ßar
        markTimeout();
      }
    }, 1000);
  }

  function stopTimer(){
    if(timerInterval) { clearInterval(timerInterval); timerInterval = null; }
  }

  function markTimeout(){
    // revelar resposta correta e marcar erro
    const q = questions[currentIndex];
    const optionsButtons = [...optionsEl.children];
    optionsButtons.forEach((btn, i) => {
      btn.classList.add('disabled');
      if(i === q.correct){
        btn.classList.add('correct');
        const icon = document.createElement('span'); icon.textContent = ' ‚úÖ'; btn.appendChild(icon);
      }
    });
    // registrar como errado
    wrongs.push({ question: q.text, chosen: null, correct: q.options[q.correct] });
    nextBtn.classList.remove('hidden');
    stopTimer();
    saveState();
  }

  /**********************
   * Resposta do usu√°rio
   **********************/
  function handleAnswer(selectedIndex, btn){
    const q = questions[currentIndex];
    const buttons = [...optionsEl.children];
    // desabilita todos
    buttons.forEach(b => { b.classList.add('disabled'); });
    // marca sele√ß√£o
    if(selectedIndex === q.correct){
      btn.classList.add('correct');
      btn.style.background = '#dcfce7';
      score++;
      const tick = document.createElement('span'); tick.textContent = ' ‚úÖ'; tick.className='ml-2'; btn.appendChild(tick);
    } else {
      btn.classList.add('incorrect');
      btn.style.background = '#fee2e2';
      const cross = document.createElement('span'); cross.textContent = ' ‚ùå'; cross.className='ml-2'; btn.appendChild(cross);
      // mostra o correto
      const correctBtn = buttons[q.correct];
      if(correctBtn){
        correctBtn.classList.add('correct');
        const tick = document.createElement('span'); tick.textContent = ' ‚úÖ'; tick.className='ml-2'; correctBtn.appendChild(tick);
      }
      wrongs.push({ question: q.text, chosen: q.options[selectedIndex], correct: q.options[q.correct] });
    }

    // pequeno delay para salvar e permitir ver o feedback
    stopTimer();
    nextBtn.classList.remove('hidden');
    saveState();
  }

  /**********************
   * navegar pr√≥ximas / pular / sair
   **********************/
  nextBtn.addEventListener('click', () => {
    currentIndex++;
    remaining = timePerQuestion;
    saveState();
    if(currentIndex < questions.length){
      renderQuestion();
      startTimer();
    } else {
      finishQuiz();
    }
  });

  skipBtn.addEventListener('click', () => {
    // marcar como pulo = tratado como errada sem chosen
    const q = questions[currentIndex];
    wrongs.push({ question: q.text, chosen: null, correct: q.options[q.correct] });
    currentIndex++;
    remaining = timePerQuestion;
    saveState();
    if(currentIndex < questions.length){
      renderQuestion();
      startTimer();
    } else {
      finishQuiz();
    }
  });

  quitBtn.addEventListener('click', () => {
    if(confirm('Deseja realmente sair e salvar seu progresso para retomar depois?')) {
      saveState();
      showStartScreen();
    }
  });

  /**********************
   * Finalizar quiz / resultados
   **********************/
  function finishQuiz(){
    stopTimer();
    saveState(); // guarda estado final
    // mostrar resultados
    quizCard.classList.add('hidden');
    resultCard.classList.remove('hidden');

    finalScore.textContent = score;
    totalQ.textContent = questions.length;
    // mensagem personalizada
    const pct = Math.round((score / questions.length) * 100);
    let msg = '';
    if(pct === 100) msg = 'Perfeito! Voc√™ domina o assunto. üëè';
    else if(pct >= 80) msg = 'Excelente! Muito bem.';
    else if(pct >= 50) msg = 'Bom trabalho ‚Äî continue praticando.';
    else msg = 'N√£o desanime ‚Äî pr√°tica leva √† melhora!';

    resultMsg.textContent = msg;

    // lista de erradas
    wrongList.innerHTML = '';
    if(wrongs.length){
      const h = document.createElement('h4'); h.className='font-semibold text-red-600'; h.textContent = 'Quest√µes que voc√™ errou:'; wrongList.appendChild(h);
      wrongs.forEach(w => {
        const div = document.createElement('div');
        div.className = 'mt-2 p-3 bg-red-50 rounded';
        div.innerHTML = `<p class="text-sm"><strong>‚ùì ${w.question}</strong></p>
                         <p class="text-xs text-red-600">Sua resposta: ${w.chosen ?? '‚Äî (n√£o respondeu)'}</p>
                         <p class="text-xs text-green-700">Resposta certa: ${w.correct}</p>`;
        wrongList.appendChild(div);
      });
    } else {
      const p = document.createElement('p'); p.className='text-green-700 font-semibold'; p.textContent = 'üéâ Voc√™ n√£o errou nenhuma quest√£o!';
      wrongList.appendChild(p);
    }

    // salvar hist√≥rico e limpar estado salvo
    addHistoryEntry(score);
    clearState();
    renderRanking(); // atualiza ranking na mem√≥ria
  }

  /**********************
   * Compartilhar / ranking
   **********************/
  shareBtn.addEventListener('click', async () => {
    const text = `Fiz o Quiz e acertei ${score} de ${questions.length} perguntas!`;
    if(navigator.share){
      try { await navigator.share({ title:'Meu resultado', text }); }
      catch(e){ alert('Compartilhamento cancelado.'); }
    } else {
      // fallback: link whatsapp
      const url = `https://api.whatsapp.com/send?text=${encodeURIComponent(text)}`;
      window.open(url, '_blank');
    }
  });

  tryAgainBtn.addEventListener('click', () => { initNewQuiz(); });
  backHomeBtn.addEventListener('click', () => { showStartScreen(); });

  viewRankingBtn.addEventListener('click', () => {
    startScreen.classList.add('hidden');
    quizCard.classList.add('hidden');
    resultCard.classList.add('hidden');
    rankingCard.classList.remove('hidden');
    renderRanking();
  });

  closeRankingBtn.addEventListener('click', () => {
    showStartScreen();
  });

  clearRankingBtn.addEventListener('click', () => {
    if(confirm('Limpar todo o hist√≥rico de pontua√ß√µes?')) {
      localStorage.removeItem(HISTORY_KEY);
      renderRanking();
    }
  });

  function renderRanking(){
    const hist = getHistory();
    rankingList.innerHTML = '';
    if(!hist.length){
      rankingList.innerHTML = '<p class="text-gray-500">Nenhuma pontua√ß√£o registrada.</p>';
      return;
    }
    hist.forEach((h, i) => {
      const li = document.createElement('li');
      const date = new Date(h.date);
      li.className = 'py-2 border-b last:border-b-0';
      li.innerHTML = `<strong>#${i+1}</strong> ‚Äî <span class="ml-2 font-semibold">${h.score}/${h.total}</span> <span class="ml-2 text-xs text-gray-500">(${date.toLocaleString()})</span>`;
      rankingList.appendChild(li);
    });
  }
  
  /**********************
   * In√≠cio / eventos de UI
   **********************/
  startBtn.addEventListener('click', () => { initNewQuiz(); });
  resumeBtn.addEventListener('click', tryResume);
  timePerQuestionSel.addEventListener('change', (e) => { /* s√≥ muda na nova sess√£o */ });

  // checar se existe estado salvo para habilitar retomar
  (function init(){
    const st = loadState();
    if(st) resumeBtn.classList.remove('hidden'); else resumeBtn.classList.add('hidden');
    renderRanking();
  })();

  </script>
</body>
</html>





























































